<?php
class ProductoController {
    private $productoModel;
    
    public function __construct($db) {
        $this->productoModel = new ProductoModel($db);
    }
    
    public function listar() {
        $productos = $this->productoModel->getAll();
        include '../../view/productos/listar.php';
    }
    
    public function agregar() {
        if ($_POST) {
            $data = [
                'id_ferreteria' => 1, // Por defecto
                'id_categoria' => $_POST['id_categoria'],
                'nombre' => $_POST['nombre'],
                'prestacion' => $_POST['prestacion'],
                'precio_compra' => $_POST['precio_compra'],
                'precio_venta' => $_POST['precio_venta'],
                'descuento' => $_POST['descuento']
            ];
            
            if ($this->productoModel->create($data)) {
                header('Location: index.php?controller=producto&action=listar&exito=1');
            } else {
                header('Location: index.php?controller=producto&action=agregar&error=1');
            }
            exit;
        }
        include '../../view/productos/agregar.php';
    }
}
?>
